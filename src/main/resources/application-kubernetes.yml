# ===================================================================
# 開發環境設定檔
# ===================================================================

# ----------------------------------------
# CORE PROPERTIES
# ----------------------------------------

# LOGGING
# 使用「spring-boot-starter-logging」內建的 logback
# https://docs.spring.io/spring-boot/docs/current/reference/html/howto-logging.html
logging:
# 使用 Spring Boot 預設值（Log 顯示在 Console），所以將以下設定註解掉
  file: /tmp/app.log
  level:
    com.twlife.msa.poc: DEBUG
#    org.springframework.web: DEBUG
    org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE
#    org.springframework.data.jpa.repository.query.SpelExpressionStringQueryParameterBinder: OFF
    org.springframework.security: INFO

# IDENTITY (ContextIdApplicationContextInitializer)
spring:
  datasource:
    driver-class-name: org.postgresql.Driver
    # https://stackoverflow.com/questions/35531661
    # url: jdbc:postgresql://postgresql96:5432/msa_poc
    url: jdbc:postgresql://${K8S_POSTGRES_DB_HOST}:${K8S_POSTGRES_DB_PORT}/msa_poc
    username: ${K8S_POSTGRES_DB_USERNAME:msa_poc_mgr}
    password: ${K8S_POSTGRES_DB_PASSWORD:test123}
    validationQuery: SELECT 1
# Workaround for docker-compose startup order problems.
# docker-compose will attempt to start spanners-api before the database
# is finished initializing. By default, Spring Boot config will fail to
# start the app. continue-on-error allows it to start and retry later.
#    continue-on-error: true
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    properties:
      hibernate:
        format_sql: true
  cloud:
    kubernetes:
      config:
        enabled: true
      discovery:
        all-namespaces: true

# ----------------------------------------
# WEB PROPERTIES
# ----------------------------------------

# EMBEDDED SERVER CONFIGURATION (ServerProperties)
server:
  port: 8080
# contextPath: /web
# 如果關閉 SSL 以後，無法以 Chrome 登入，請先使用「開發者工具」
# 中的「Application -> Clear Storage」將全部的相關資料都清
# 除，包含：Application, Storage, Cache 等。
#  ssl:
#    enabled: true
#    key-store: classpath:keystore.jks
#    key-store-password: 1qaz@WSX
#    keyAlias: tomcat
